# Halo Blog Tools v0.0.5 使用指南

## 版本亮点

✅ **编辑器兼容性完全修复** - API创建的文章可在编辑器中正常编辑  
✅ **文章更新真正生效** - 修复了更新后内容不变的问题  
✅ **稳定性大幅提升** - 修复了多个潜在的错误和异常  

## 安装部署

### 1. 下载插件包
- 文件名: `halo-blog-tools-v0.0.5.difypkg`
- 大小: 约150KB
- 支持平台: Dify AI平台

### 2. 安装步骤
1. 登录Dify控制台
2. 进入"工具"页面
3. 如有旧版本，先卸载
4. 点击"上传插件"
5. 选择`halo-blog-tools-v0.0.5.difypkg`文件
6. 等待安装完成

### 3. 配置连接
安装后需要配置Halo CMS连接信息：
- **Base URL**: 你的Halo站点地址（如：https://blog.example.com）
- **Access Token**: Halo个人访问令牌（以`pat_`开头）

## 功能使用

### 📝 文章创建（已修复编辑器兼容性）

**功能**: 创建新文章，完全支持编辑器编辑

**参数说明**:
- `title` (必填): 文章标题
- `content` (必填): 文章内容（支持Markdown）
- `slug` (可选): 文章访问路径
- `tags` (可选): 标签，逗号分隔
- `categories` (可选): 分类，逗号分隔
- `excerpt` (可选): 文章摘要
- `publish_immediately` (可选): 是否立即发布
- `editor_type` (可选): 首选编辑器类型

**使用示例**:
```
标题: 我的第一篇博客
内容: # 欢迎来到我的博客

这是我的第一篇文章...

标签: 博客,生活,技术
分类: 个人日记
立即发布: 否
编辑器类型: 默认富文本编辑器
```

**修复效果**:
- ✅ 创建的文章可在编辑器中正常打开
- ✅ Markdown格式正确显示
- ✅ 支持所有编辑器功能（预览、保存、发布）

### 📝 文章更新（已修复更新失效问题）

**功能**: 更新现有文章，确保内容真正变更

**参数说明**:
- `post_id` (必填): 文章ID
- `title` (可选): 新标题
- `content` (可选): 新内容
- `tags` (可选): 新标签
- `categories` (可选): 新分类
- `published` (可选): 发布状态
- `editor_type` (可选): 编辑器类型

**使用示例**:
```
文章ID: post-1234567890
标题: 更新后的文章标题
内容: # 更新内容

这是更新后的文章内容...

标签: 更新,测试
```

**修复效果**:
- ✅ 更新操作确保内容真正变更
- ✅ 保持编辑器兼容性
- ✅ 提供详细的更新状态反馈
- ✅ 支持部分字段更新

### 📋 其他功能

**文章管理**:
- `halo-post-list`: 获取文章列表
- `halo-post-get`: 获取单篇文章详情
- `halo-post-delete`: 删除文章

**分类标签管理**:
- `halo-categories-list`: 获取分类列表
- `halo-tags-list`: 获取标签列表

**瞬间功能**:
- `halo-moment-create`: 创建瞬间动态
- `halo-moment-list`: 获取瞬间列表

**系统配置**:
- `halo-setup`: 配置和测试连接

## 编辑器支持

### 支持的编辑器类型
1. **默认富文本编辑器** (`default`)
2. **StackEdit Markdown编辑器** (`stackedit`)
3. **ByteMD Markdown编辑器** (`bytemd`)
4. **Vditor编辑器** (`vditor`) - 需要安装插件

### 编辑器兼容性特性
- ✅ **自动注解设置**: 创建文章时自动添加编辑器识别注解
- ✅ **格式保持**: Markdown格式在编辑器中正确显示
- ✅ **无缝切换**: API和编辑器之间可以无缝切换编辑
- ✅ **功能完整**: 支持预览、保存、发布等所有功能

## 故障排除

### 常见问题

**Q1: 文章创建成功但编辑器打不开？**
A1: 
- 检查编辑器插件是否已安装
- 确认文章ID正确
- 尝试刷新浏览器

**Q2: 文章更新后内容没有变化？**
A2: 
- 确认使用的是v0.0.5版本
- 检查访问令牌权限
- 查看详细的状态报告

**Q3: 提示认证失败？**
A3:
- 检查Access Token是否正确
- 确认Token具有文章管理权限
- 验证Halo站点地址是否正确

**Q4: 标签或分类创建失败？**
A4:
- 检查标签/分类名称是否合法
- 确认没有重复的名称
- 尝试手动在后台创建

### 调试方法

**启用详细日志**:
插件会在控制台输出详细的调试信息，包括：
- API请求和响应
- 错误详情
- 执行状态

**检查API响应**:
每个操作都会返回详细的JSON响应，包含：
- 操作结果状态
- 文章ID和基本信息
- 编辑器兼容性状态
- 错误信息（如有）

## 最佳实践

### 文章创建
1. **使用描述性标题**: 便于管理和搜索
2. **合理设置标签**: 不超过5个，使用常见词汇
3. **选择合适的编辑器**: 根据内容类型选择
4. **先创建草稿**: 重要文章建议先保存为草稿

### 文章更新
1. **备份重要内容**: 更新前建议备份原内容
2. **分步更新**: 大量修改建议分多次进行
3. **验证更新结果**: 更新后在编辑器中确认效果
4. **注意发布状态**: 避免意外发布未完成的内容

### 性能优化
1. **批量操作**: 多篇文章建议分批处理
2. **合理频率**: 避免过于频繁的API调用
3. **网络稳定**: 确保网络连接稳定
4. **及时清理**: 定期清理测试文章

## 版本历史

### v0.0.5 (2025-07-01) - 当前版本
- ✅ 修复文章更新实际未更新的问题
- ✅ 修复datetime导入缺失
- ✅ 重构更新逻辑，确保内容真正变更
- ✅ 改进错误处理和状态报告

### v0.0.4 (2025-01-30)
- ✅ 修复文章创建编辑器兼容性问题
- ✅ 添加编辑器识别注解
- ✅ 实现快照机制

### v0.0.3 (2025-06-30)
- ✅ 修复瞬间时间戳显示问题
- ✅ 修复标签分行问题

### v0.0.2 (2025-06-29)
- ✅ 修复瞬间创建标签显示问题
- ✅ 修复文章发布状态问题

## 技术支持

### 获取帮助
- 查看详细的错误信息和状态报告
- 检查Halo API文档: https://docs.halo.run
- 确认插件版本是否为最新

### 反馈问题
如遇到问题，请提供：
1. 插件版本号
2. Halo版本信息
3. 详细的错误信息
4. 操作步骤描述

---

**插件版本**: v0.0.5  
**更新时间**: 2025-07-01  
**兼容性**: Halo 2.x, Dify AI平台  
**状态**: ✅ 稳定版本
